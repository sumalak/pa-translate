# pa-translate

With these tools you can make your own translation more easily without much handwork. 

## How it works

1. Install Python, Python PIL library, Python Polib library.
2. Download all scripts from this repository and put them in folder.
3. Open in editor makefont.py.
4. Replace existing russian characters with your native language characters and replace font paths.
5. Run: python makefont.py
6. Open verdana-bold-outline.png and save as verdana-bold-outline.bmp.
7. Replace original game fonts.
8. Download ready to use translated prison_architect.po files from [Prison Architect translation project on Zanata.org][zanata-project]. You may be need to [sign up][zanata-sign-up], [join a language][zanata-join-language] and HELP translate game to your native language (you can contact [David Mason][github-davidmason] on Zanata team if you need help).
9. Run: python po2prison.py prison_architect.po
10. Open in editor native2custom.py.
11. Replace existing russian characters with your native language characters according to makefont.py.
12. Run: python native2custom.py base-language.txt.native
13. Replace original game translation.
14. Done.

For more detailed description read below.

## makefont.py

Usage: python makefont.py

Dependencies: Python PIL library

Description: It generates any custom fonts. Currectly contain russian characters, replacing western-european characters. Before making your own fonts you need replace characters with your own alphabet. Leave english characters untouched, so you may be sure to see english text in game (if its presented). Then replace original font file <game folder>/data/fonts/catalogue.bmp, verdana.bmp and verdana-bold.bmp. At the moment i didnt make verdana-bold-outlined.bmp fonts to work. In progress.

## po2prison.py

Usage: python po2prison.py prison_architect.po

Dependencies: Python Polib library

Description: Generate base-language.txt.native file with all strings translated according to provided prison_architect.po file with your translation. You can download ready prison_architect.po translations from [Prison Architect translation project on Zanata.org][zanata].

## native2custom.py

Usage: python native2custom.py base-language.txt.native

Dependencies: no

Description: Convert all characters  You need to rename "base-language.txt.custom" to "base-language.txt" and put it to <game folder>/data/language/ with overwrite. At the moment this script configured to convert russian characters to western-european.

## prison2pot.py

Usage: python prison2pot.py base-language.txt

Dependencies: Python Polib library

Description: It have no currently usage for translating participants. I used it to create Gettext template from <game folder>/data/language/base-language.txt and upload it on Zanata.org.

## Additional information

.po file is Gettext format file for helping translators. It is actually .txt format, but it have structured information about translated strings. It may be easily edited. I recommend use Poedit editor (google it). But Gettext is not native format for Prison Architect and i use my own python script to convert .po file to <game folder>/data/language/base-language.txt.

Possible game files structure is:

* lib
* lib64
* main.dat
* PrisonArchitect.i686
* PrisonArchitect.x86_64
* sounds.dat

Then you need to unpack main.dat (it is actually a RAR archive) in game folder and rename main.dat to main1.dat (game will load unpacked data).

Bitmap font parameters:

* catalogue.bmp - Grayscale
* verdana.bmp - Grayscale
* verdana-bold.bmp - Grayscale
* verdana-bold-outlined.bmp - GrayscaleAlpha, BMP3 (Microsoft Windows bitmap image (V3))

GIMP export options: do not save colors, not run-length encoded.

## Story (>áƒš)

Following information from website of ImageMagick.

> I've installed Xnview and it does indicate that a BMP3 file that I created with nconvert has transparency. So, I looked at a hexdump of the file.
> The BMP3 file header indicates that the image has 32-bits per pixel. Nconvert has used the high byte of each DWORD to indicate the opacity of the pixel. If it is zero, the pixel is transparent and if it is 255 the pixel is fully opaque. I haven't tried to sort out whether Nconvert will produce a BMP3 with partially transparent pixels nor whether Xnview could display one properly.
> However, BMP is a Microsoft file format and the documentation that comes with my C compiler, and also what I have found on Microsoft's website, says that the high byte of each DWORD is unused. Therefore using this byte for opacity (or anything else) is a non-standard use.
> The specific problem that I can see right now is that because Microsoft says that the high byte is unused, programs are free to leave any random value in that byte. How do you then distinguish between a BMP generated by such a program and a BMP which is using that byte as opacity?
> I don't think that Magick (IM's developer) will expend any effort on the BMP coder to handle an apparently undefined/undocumented extension of the BMP format. If you can find documentation of this extension and how it fits in with the existing BMP3 spec maybe it will happen.

by el_supremo

[zanata-project]: https://translate.zanata.org/zanata/project/view/pa
[zanata-sign-up]: http://zanata.org/help/accounts/sign-up/
[zanata-join-language]: http://zanata.org/help/translation/translator-add/
[github-davidmason]: https://github.com/davidmason/
